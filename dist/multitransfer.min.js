var global_keystore,web3=new Web3;function setWeb3Provider(e){var t=new HookedWeb3Provider({host:"https://mainnet.infura.io/KTxDHirVMJjBc0oLkjR2",transaction_signer:e});web3.setProvider(t)}function newAddresses(e){""==e&&(e=prompt("Enter password to retrieve addresses","Password"));var t=parseInt(document.getElementById("numAddr").value);global_keystore.keyFromPassword(e,function(e,o){global_keystore.generateNewAddress(o,t);var s=global_keystore.getAddresses();document.getElementById("sendFrom").innerHTML="";for(var n=0;n<s.length;++n)document.getElementById("sendFrom").innerHTML+='<option value="'+s[n]+'">'+s[n]+"</option>";getBalances()})}function getBalances(){var e=global_keystore.getAddresses();document.getElementById("addr").innerHTML="Retrieving addresses...",async.map(e,web3.eth.getBalance,function(t,o){async.map(e,web3.eth.getTransactionCount,function(t,s){document.getElementById("addr").innerHTML="";for(var n=0;n<e.length;++n)document.getElementById("addr").innerHTML+="<div>"+e[n]+" (Bal: "+o[n]/1e18+" ETH, Nonce: "+s[n]+")</div>"})})}function setSeed(){var e=prompt("输入这个钱包的密码","Password");lightwallet.keystore.createVault({password:e,seedPhrase:document.getElementById("seed").value,hdPathString:"m/0'/0'/0'"},function(t,o){global_keystore=o,document.getElementById("seed").value="",newAddresses(e),setWeb3Provider(global_keystore),getBalances()})}function newWallet(){var e=document.getElementById("userEntropy").value;document.getElementById("userEntropy").value="";var t=lightwallet.keystore.generateRandomSeed(e),o=prompt('助记词： "'+t+'"',"Password");lightwallet.keystore.createVault({password:o,seedPhrase:t,hdPathString:"m/0'/0'/0'"},function(e,t){global_keystore=t,newAddresses(o),setWeb3Provider(global_keystore),getBalances()})}function showSeed(){var e=prompt("Enter password to show your seed. Do not let anyone else see your seed.","Password");global_keystore.keyFromPassword(e,function(e,t){var o=global_keystore.getSeed(t);alert('Your seed is: "'+o+'". Please write it down.')})}function sendEth(){var e=document.getElementById("sendFrom").value,t=document.getElementById("sendTo").value,o=document.getElementById("sendValueAmount").value,s=1e18*parseFloat(o),n=document.getElementById("sendGasPrice").value,r=document.getElementById("sendGas").value;web3.eth.sendTransaction({from:e,to:t,value:s,gasPrice:n,gas:r},function(e,t){console.log("error: "+e),console.log("txhash: "+t)})}function sendEth1(e,t,o,s,n){var r=1e18*parseFloat(o);console.log("step 3"),web3.eth.sendTransaction({from:e,to:t,value:r,gasPrice:s,gas:n},function(e,t){console.log("error: "+e),showRecordText=showRecordText+"error: "+e+"\n",console.log("txhash: "+t),showRecordText=showRecordText+"txhash: "+t+"\n",document.getElementById("showRecord").value=showRecordText})}function sendEach(){var e=global_keystore.getAddresses();console.log(e);for(var t=document.getElementById("sendEachGasPrice").value,o=document.getElementById("sendEachGas").value,s=document.getElementById("sendEachAmt").value,n=0;n<toAddresses.length;n++)console.log("step 1"),sendEth1(e[0],toAddresses[n],s,t,o),console.log("step 2")}var toAddresses=[],showFileText="",showRecordText="";function openFile(e){var t=e[0],o=new FileReader;o.readAsText(t),o.onload=function(e){for(var t=this.result.split("\n"),o=0;o<t.length;o++){var s=t[o].indexOf("0"),n=t[o].indexOf("-");toAddresses.push(t[o].substring(s,n))}for(var r=0;r<toAddresses.length;r++)showFileText=showFileText+toAddresses[r]+"\n";document.getElementById("showFile").value=showFileText,console.log(toAddresses)}}